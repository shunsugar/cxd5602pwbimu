<?xml version="1.0"?>
<launch>
  <arg name="odom_topic" default="/odom"/>
  <arg name="imu_topic" default="/imu"/>
  <arg name="fusion_odom_topic" default="/localization/odom"/>
  <arg name="livox_scan_topic" default="/livox_scan"/>
  <arg name="livox_points_topic" default="/livox_points"/>
  <arg name="xacro_file_path" default="$(find-pkg-share orange_description)/xacro/orange_robot.xacro"/>

  <!-- robot localization -->
  <!--<include file="$(find-pkg-share orange_sensor_tools)/launch/localization.launch.xml">
    <arg name="odom_in" value="$(var odom_topic)"/>
    <arg name="imu_in" value="$(var imu_topic)"/>
    <arg name="fusion_odom_out" value="$(var fusion_odom_topic)"/>
  </include>-->

  <!-- wheel imu odom 
  <include file="$(find-pkg-share orange_sensor_tools)/launch/wheel_imu_odom.launch.xml">
    <arg name="odom_topic" value="/odom"/>
    <arg name="imu_topic" value="/imu"/>
  </include>-->

  <!-- madgwick filter node -->
  <node pkg="imu_filter_madgwick" exec="imu_filter_madgwick_node" name="madgwick_filter">
    <param from="$(find-pkg-share cxd5602pwbimu)/config/madgwick.yaml"/>
    <remap from="/imu/data_raw" to="/imu/spresense"/>
    <remap from="/imu/data" to="/imu/spresense/madgwick"/>
  </node>
  <!-- initial yaw corrector -->
  <node pkg="cxd5602pwbimu" exec="initial_yaw_corrector" name="spimu_yaw_corrector">
    <param name="input_topic" value="/imu/spresense/madgwick"/>
    <param name="output_topic" value="/imu/spresense/inityaw"/>
  </node>
  <!-- wheel imu odom for spresense imu -->
  <node pkg="cxd5602pwbimu" exec="wheel_spimu_odom">
    <param name="odom_topic" value="/odom"/>
    <param name="imu_topic" value="/imu/spresense/inityaw"/>
    <param name="publish_TF" value="false"/>
  </node>

  <!-- livox to pointcloud2 -->
  <node pkg="livox_to_pointcloud2" exec="livox_to_pointcloud2_node">
    <remap from="/livox_pointcloud" to="/livox/lidar"/>
  </node>
  <!-- ground segmentation2 
  <include file="$(find-pkg-share pcd_convert)/launch/pcd_convert.launch.py"/>-->
  <!-- pointcloud2 to laserscan -->
  <include file="$(find-pkg-share orange_sensor_tools)/launch/livox_to_pointcloud2_laserscan.launch.py">
    <arg name="cloud_in" value="/converted_pointcloud2"/>
    <arg name="scan_out" value="$(var livox_scan_topic)"/>
  </include>
</launch>
